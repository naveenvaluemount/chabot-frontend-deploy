"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[547],{1547:(B,g,n)=>{n.r(g),n.d(g,{UsersModule:()=>m});var l=n(6895),i=n(4006),h=n(9080),_=n(3419),u=n(2722),e=n(4650),C=n(9274),U=n(7401),T=n(7009),v=n(4859),Z=n(7392),b=n(284),d=n(9549),A=n(4385),N=n(3238);const x=["statusTemp"],I=["orgsTemp"],q=["actionsTemp"];function y(r,t){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&r){const s=t.$implicit,a=t.last;e.xp6(1),e.AsE(" ",s.clientName,"",a?"":","," ")}}function J(r,t){if(1&r&&(e.YNc(0,y,2,2,"span",6),e.ALo(1,"slice"),e._uU(2)),2&r){const s=t.row;e.Q6J("ngForOf",e.Dn7(1,2,s.organizationDtos,0,2)),e.xp6(2),e.hij(" +",s.organizationDtos.length-2," ")}}function L(r,t){if(1&r){const s=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){const c=e.CHM(s).row,f=e.oxw();return e.KtG(f.deleteFn(c))}),e._UZ(1,"mat-icon",8),e.qZA(),e.TgZ(2,"button",9),e.NdJ("click",function(){const c=e.CHM(s).row,f=e.oxw();return e.KtG(f.updateFn(c))}),e._UZ(3,"mat-icon",8),e.qZA()}2&r&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:trash"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:pencil"))}const k=function(r,t){return{"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":r,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":t}};function O(r,t){if(1&r&&(e.TgZ(0,"span",10)(1,"span",11),e._uU(2),e.qZA()()),2&r){const s=t.row;e.Q6J("ngClass",e.WLB(2,k,"inActive"==s.status,"active"==s.status)),e.xp6(2),e.Oqu(s.status)}}function R(r,t){if(1&r&&(e.TgZ(0,"form",12)(1,"div")(2,"mat-form-field",13)(3,"mat-label"),e._uU(4,"Status"),e.qZA(),e.TgZ(5,"mat-select",14)(6,"mat-option",15),e._uU(7,"Active"),e.qZA(),e.TgZ(8,"mat-option",16),e._uU(9,"Inactive"),e.qZA()()()()()),2&r){const s=e.oxw();e.Q6J("formGroup",s.form)}}function Q(r,t){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"*Required "),e.qZA())}function Y(r,t){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"*Required "),e.qZA())}function E(r,t){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"*Required "),e.qZA())}function S(r,t){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Invalid Email "),e.qZA())}function z(r,t){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"*Required "),e.qZA())}function M(r,t){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Invalid Phone Number"),e.qZA())}function w(r,t){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"*Required "),e.qZA())}function F(r,t){if(1&r&&(e.TgZ(0,"mat-option",29),e._uU(1),e.qZA()),2&r){const s=t.$implicit;e.Q6J("value",s._id),e.xp6(1),e.Oqu(s.clientName)}}function P(r,t){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"*Required "),e.qZA())}function G(r,t){if(1&r&&(e.TgZ(0,"mat-option",29),e._uU(1),e.qZA()),2&r){const s=t.$implicit;e.Q6J("value",s.value),e.xp6(1),e.hij(" ",s.name," ")}}function D(r,t){if(1&r&&(e.TgZ(0,"div")(1,"mat-form-field",18)(2,"mat-label"),e._uU(3,"Status"),e.qZA(),e.TgZ(4,"mat-select",30),e.YNc(5,G,2,2,"mat-option",28),e.qZA()()()),2&r){const s=e.oxw(2);e.xp6(5),e.Q6J("ngForOf",s.statusList)}}const H=function(r){return{"col-span-2":r}};function W(r,t){if(1&r&&(e.TgZ(0,"form",12)(1,"div",17)(2,"div")(3,"mat-form-field",18)(4,"mat-label"),e._uU(5,"First Name"),e.qZA(),e._UZ(6,"input",19),e.YNc(7,Q,2,0,"mat-error",20),e.qZA()(),e.TgZ(8,"div")(9,"mat-form-field",18)(10,"mat-label"),e._uU(11,"Last Name"),e.qZA(),e._UZ(12,"input",21),e.YNc(13,Y,2,0,"mat-error",20),e.qZA()(),e.TgZ(14,"div",22)(15,"mat-form-field",18)(16,"mat-label"),e._uU(17,"email"),e.qZA(),e._UZ(18,"input",23),e.YNc(19,E,2,0,"mat-error",20),e.YNc(20,S,2,0,"mat-error",20),e.qZA()(),e.TgZ(21,"div",22)(22,"mat-form-field",18)(23,"mat-label"),e._uU(24,"Mobile"),e.qZA(),e._UZ(25,"input",24),e.YNc(26,z,2,0,"mat-error",20),e.YNc(27,M,2,0,"mat-error",20),e.qZA()(),e.TgZ(28,"div",22)(29,"mat-form-field",18)(30,"mat-label"),e._uU(31,"Password"),e.qZA(),e._UZ(32,"input",25),e.YNc(33,w,2,0,"mat-error",20),e.qZA()(),e.TgZ(34,"div",26)(35,"mat-form-field",18)(36,"mat-label"),e._uU(37,"Organization"),e.qZA(),e.TgZ(38,"mat-select",27),e.YNc(39,F,2,2,"mat-option",28),e.qZA(),e.YNc(40,P,2,0,"mat-error",20),e.qZA()(),e.YNc(41,D,6,1,"div",20),e.qZA()()),2&r){const s=e.oxw();e.Q6J("formGroup",s.form),e.xp6(7),e.Q6J("ngIf",s.form.get("firstname").hasError("required")),e.xp6(6),e.Q6J("ngIf",s.form.get("lastname").hasError("required")),e.xp6(6),e.Q6J("ngIf",s.form.get("email").hasError("required")),e.xp6(1),e.Q6J("ngIf",s.form.get("email").hasError("email")),e.xp6(6),e.Q6J("ngIf",s.form.get("phoneNumber").hasError("required")),e.xp6(1),e.Q6J("ngIf",s.form.get("phoneNumber").hasError("pattern")),e.xp6(6),e.Q6J("ngIf",s.form.get("password").hasError("required")),e.xp6(1),e.Q6J("ngClass",e.VKq(12,H,!s.form.get("userId").value)),e.xp6(5),e.Q6J("ngForOf",s.orgs),e.xp6(1),e.Q6J("ngIf",s.form.get("orgIds").hasError("required")),e.xp6(1),e.Q6J("ngIf",s.form.get("userId").value)}}class p extends _.f{constructor(t,s,a,o,c){super(),this.api=t,this.cd=s,this.fb=a,this.fcs=o,this.snackbar=c,this.isEmpty=!1,this.isLoaded=!1,this.breadcrumbs=[{name:"Home",link:""},{name:"Users",link:""}],this.statusList=[{id:0,name:"Active",value:"active"},{id:1,name:"In Active",value:"inActive"}],this.form=this.fb.group({firstname:["",[i.kI.required]],lastname:["",[i.kI.required]],orgIds:[[],[i.kI.required]],phoneNumber:["",[i.kI.required,i.kI.pattern(this.api.patterns.mobile)]],roleId:6,updateOrganization:!0,updateRoles:!0,userId:[null],email:["",[i.kI.required,i.kI.email]],password:["",i.kI.required],status:[""],filterStatus:["active"]}),this.userParams={keyword:"",colName:"user_name",pageSize:25,pageNumber:0,orderby:!1,status:"",pageCount:0,pageSizes:[5,10,25]},this.data=[{id:0,email:"naveen@gmail.com",firstname:"Naveen",role:"admin",status:"active",organizationDtos:[{id:1,clientName:"Akhil"},{id:2,clientName:"Mohith"}]},{id:1,email:"akhil@gmail.com",firstname:"Akhil",role:"admin",status:"active",organizationDtos:[{id:1,clientName:"Naveen"}]},{id:2,email:"mohith@gmail.com",firstname:"Mohith",role:"admin",status:"active",organizationDtos:[{id:1,clientName:"Akhil"},{id:2,clientName:"Naveen"},{id:3,clientName:"kumar"}]}]}getList(){this.users=this.data,this.isLoaded=!0,this.isEmpty=!1;let{pageCount:t,pageSizes:s,...a}=this.userParams;this.api.allUsers(a).pipe((0,u.R)(this.unsubscribe)).subscribe(o=>{200===o.statusCode&&(this.isLoaded=!0,200===o.statusCode&&(this.isEmpty=!1,this.users=o.response,this.userParams.pageCount=o?.count,this.isEmpty=0==o.response.count))})}getOrgList(){this.api.allOrgs({}).pipe((0,u.R)(this.unsubscribe)).subscribe(t=>{200===t.statusCode&&200===t.statusCode&&(this.orgs=t.response)})}onSubmit(){this.form.valid?this.api.addUser(this.form.value).pipe((0,u.R)(this.unsubscribe)).subscribe(t=>{200===t.statusCode&&200===t.statusCode&&(this.crud.toggle(null),this.isLoaded=!1,this.snackbar.open("User Added",null,{duration:1e3}),this.getList())}):this.form.markAllAsTouched()}updateFn(t){this.crud.toggle("edit"),this.form.patchValue(t);let s=t.organizationDtos.map(a=>a._id);this.form.get("orgIds").setValue(s),console.log(t,this.form.value),this.form.get("userId").setValue(t._id)}onUpdate(){this.form.valid?this.api.addUser(this.form.value).pipe((0,u.R)(this.unsubscribe)).subscribe(t=>{200===t.statusCode&&200===t.statusCode&&(this.crud.toggle(null),this.isLoaded=!1,this.snackbar.open("User Updated",null,{duration:1e3}),this.getList())}):this.form.markAllAsTouched()}deleteFn(t){this.fcs.open().afterClosed().pipe((0,u.R)(this.unsubscribe)).subscribe(a=>{"confirmed"===a&&this.api.deleteUser(t._id).subscribe(o=>{200===o.statusCode&&200===o.statusCode&&(this.isLoaded=!1,this.snackbar.open("User Deleted",null,{duration:1e3}),this.getList())})})}onApply(){this.userParams.status=this.form.value?.status,this.getList()}onSearch(t){this.isLoaded=!1,this.userParams.keyword=t.value?t.value:"",this.getList()}onChange(t){t||this.form.reset({status:this.form.get("status").value})}onPageChange(t){this.userParams.pageNumber=t.pageIndex,this.userParams.pageSize=t.pageSize,this.getList(),this.getOrgList()}ngOnInit(){this.getList(),this.getOrgList()}ngAfterViewInit(){this.columns=[{prop:"email",name:"Email",sort:!0},{prop:"firstname",name:"Name",sort:!0},{prop:"organizationDtos",name:"Organizations",cellTemplate:this.orgsTemp},{prop:"role",name:"Role",sort:!0},{prop:"status",name:"Status",cellTemplate:this.statusTemp,sort:!0},{prop:"actions",name:"Actions",cellTemplate:this.actionsTemp,class:" md:block !flex-0 basis-[100px]"}],this.cd.detectChanges()}}p.\u0275fac=function(t){return new(t||p)(e.Y36(C.sM),e.Y36(e.sBO),e.Y36(i.qu),e.Y36(U.R),e.Y36(T.ux))},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-users"]],viewQuery:function(t,s){if(1&t&&(e.Gf(h.D,5),e.Gf(x,5),e.Gf(I,5),e.Gf(q,5)),2&t){let a;e.iGM(a=e.CRH())&&(s.crud=a.first),e.iGM(a=e.CRH())&&(s.statusTemp=a.first),e.iGM(a=e.CRH())&&(s.orgsTemp=a.first),e.iGM(a=e.CRH())&&(s.actionsTemp=a.first)}},hostAttrs:[1,"flex","flex-col","flex-auto"],features:[e.qOj],decls:11,vars:8,consts:[[3,"isEmpty","isLoaded","rows","columns","breadcrumbs","formTemplate","filterTemplate","pagination","onPageChange","onSubmit","onApply","onUpdate","onChange","onSearch"],["orgsTemp",""],["actionsTemp",""],["statusTemp",""],["filterTemplate",""],["formTemplate",""],[4,"ngFor","ngForOf"],["data-cy","delete","type","button","mat-icon-button","",3,"click"],[3,"svgIcon"],["data-cy","edit","type","button","mat-icon-button","",3,"click"],[1,"inline-flex","items-center","font-bold","text-xs","px-2.5","py-0.5","rounded-full","tracking-wide","uppercase",3,"ngClass"],[1,"leading-relaxed","whitespace-nowrap"],[3,"formGroup"],["hideRequiredMarker","",1,"w-full"],["data-cy","status","formControlName","status"],["value","active"],["value","inActive"],[1,"grid","grid-cols-2","gap-4"],["hideRequiredMarker","","subscriptSizing","dynamic",1,"w-full"],["data-cy","firstname","matInput","","formControlName","firstname"],[4,"ngIf"],["data-cy","lastname","matInput","","formControlName","lastname"],[1,"col-span-2"],["data-cy","email","matInput","","formControlName","email"],["data-cy","phoneNumber","matInput","","formControlName","phoneNumber"],["data-cy","password","matInput","","formControlName","password"],[3,"ngClass"],["data-cy","orgIds","multiple","","formControlName","orgIds"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","status","formControlName","status"]],template:function(t,s){if(1&t&&(e.TgZ(0,"app-crud",0),e.NdJ("onPageChange",function(o){return s.onPageChange(o)})("onSubmit",function(){return s.onSubmit()})("onApply",function(){return s.onApply()})("onUpdate",function(){return s.onUpdate()})("onChange",function(o){return s.onChange(o)})("onSearch",function(o){return s.onSearch(o)}),e.qZA(),e.YNc(1,J,3,6,"ng-template",null,1,e.W1O),e.YNc(3,L,4,2,"ng-template",null,2,e.W1O),e.YNc(5,O,3,5,"ng-template",null,3,e.W1O),e.YNc(7,R,10,1,"ng-template",null,4,e.W1O),e.YNc(9,W,42,14,"ng-template",null,5,e.W1O)),2&t){const a=e.MAs(8),o=e.MAs(10);e.Q6J("isEmpty",s.isEmpty)("isLoaded",s.isLoaded)("rows",s.users)("columns",s.columns)("breadcrumbs",s.breadcrumbs)("formTemplate",o)("filterTemplate",a)("pagination",s.userParams)}},dependencies:[l.mk,l.sg,l.O5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,h.D,v.RK,Z.Hw,b.Nt,d.KE,d.hX,d.TO,A.gD,N.ey,l.OU]});var j=n(3060),K=n(2665);const V=[{path:"",component:p}];class m{}m.\u0275fac=function(t){return new(t||m)},m.\u0275mod=e.oAB({type:m}),m.\u0275inj=e.cJS({imports:[l.ez,K.m,j.Bz.forChild(V)]})}}]);